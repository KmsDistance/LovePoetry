<!DOCTYPE html>
<html>
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width,initial-scale=1" />
    <meta name="viewport" content="width=320,maximum-scale=1.3,user-scalable=no">
    <link rel="stylesheet" type="text/css" href="css/bootstrap.css"/>
    <link rel="stylesheet" href="css/bootstrapValidator.min.css">
    <link rel="stylesheet" href="css/base.css">
    <link rel="stylesheet" href="css/shoppingCenter.css">

    <script src="js/jquery.js" type="text/javascript" charset="utf-8"></script>
    <script src="js/bootstrap.js" type="text/javascript" charset="utf-8"></script>
    <script src="js/flexible.js" type="text/javascript" charset="utf-8"></script>
    <script src="js/layer/layer.js"></script>
    <script src="js/util.js"></script>
    <script src="js/bootstrapValidator.min.js"></script>
    <title>找好项目，到校长堡</title>
    <!-- 商城中心 -->
    <style>
       
    </style>
</head>
<body>

    <div>
        <div class="topTitle">
            <span>商城中心</span>
        </div>
    </div>
    <div class="afterLogin">
        <div id="changeMoney">
            <!--<img src="img/qian.png">
            <span>堡币剩余:485</span>
            <p>
                <span style="margin-left: .7rem">赠送堡币:485</span>
            </p>-->
        </div>

        <div>
            <button class="btn1" onclick="goTopup()">充值</button>
        </div>
    </div>
 <div class="product">
     <div>
         <!--自研专区-->
         <div class="lineBox">
             <h4>自研项目</h4>
             <div class="line1" id="selfRes">
                 <!--<div onclick="handleDetails()">
                         <div>
                             <img src="img/pic.jpg">
                         </div>
                         <h5>图说有道</h5>
                         <p>快速提高儿童认知语言能力快速快速...</p>
                         <div>
                             <span>￥999</span>
                             <span>￥1800</span>
                         </div>
                 </div>
                 <div>
                     <a href="#">
                         <div>
                             <img src="img/pic.jpg">
                         </div>
                         <h5>图说有道</h5>
                         <p>快速提高儿童认知语言能力快速快速...</p>
                         <div>
                             <span>￥999</span>
                             <span>￥1800</span>
                         </div>
                     </a>
                 </div>
                 <div>
                     <a href="#">
                         <div>
                             <img src="img/pic.jpg">
                         </div>
                         <h5>图说有道</h5>
                         <p>快速提高儿童认知语言能力快速快速...</p>
                         <div>
                             <span>￥999</span>
                             <span>￥1800</span>
                         </div>
                     </a>
                 </div>-->
             </div>
         </div>
         <!--行业服务专区-->
         <div class="lineBox" >
             <h4>行业服务专区</h4>
             <div class="line1"id="service">
                 <!--<div>
                         <div>
                             <img src="img/pic.jpg">
                         </div>
                         <h5>图说有道</h5>
                         <p>快速提高儿童认知语言能力快速快速...</p>
                         <div>
                             <span>￥999</span>
                             <span>￥1800</span>
                         </div>
                 </div>
                 <div>
                     <a href="#">
                         <div>
                             <img src="img/pic.jpg">
                         </div>
                         <h5>图说有道</h5>
                         <p>快速提高儿童认知语言能力快速快速...</p>
                         <div>
                             <span>￥999</span>
                             <span>￥1800</span>
                         </div>
                     </a>
                 </div>
                 <div>
                     <a href="#">
                         <div>
                             <img src="img/pic.jpg">
                         </div>
                         <h5>图说有道</h5>
                         <p>快速提高儿童认知语言能力快速快速...</p>
                         <div>
                             <span>￥999</span>
                             <span>￥1800</span>
                         </div>
                     </a>
                 </div>-->
             </div>
         </div>
         <!--课程专区-->
         <div class="lineBox">
             <h4>课程专区</h4>
             <div class="line2" id="lesson">
                 <div>
                     <a href="#">
                         <div>
                             <img src="img/pic.jpg">
                         </div>
                         <h5>图说有道</h5>
                         <p>快速提高儿童认知语言能力快速快速...</p>
                         <div>
                             <span>￥999</span>
                             <span>￥1800</span>
                         </div>
                     </a>
                 </div>
                 <div>
                     <a href="#">
                         <div>
                             <img src="img/pic.jpg">
                         </div>
                         <h5>图说有道</h5>
                         <p>快速提高儿童认知语言能力快速快速...</p>
                         <div>
                             <span>￥999</span>
                             <span>￥1800</span>
                         </div>
                     </a>
                 </div>
                 <div>
                     <a href="#">
                         <div>
                             <img src="img/pic.jpg">
                         </div>
                         <h5>图说有道</h5>
                         <p>快速提高儿童认知语言能力快速快速...</p>
                         <div>
                             <span>￥999</span>
                             <span>￥1800</span>
                         </div>
                     </a>
                 </div>
                 <div>
                     <a href="#">
                         <div>
                             <img src="img/pic.jpg">
                         </div>
                         <h5>图说有道</h5>
                         <p>快速提高儿童认知语言能力快速快速...</p>
                         <div>
                             <span>￥999</span>
                             <span>￥1800</span>
                         </div>
                     </a>
                 </div>
                 <div>
                     <a href="#">
                         <div>
                             <img src="img/pic.jpg">
                         </div>
                         <h5>图说有道</h5>
                         <p>快速提高儿童认知语言能力快速快速...</p>
                         <div>
                             <span>￥999</span>
                             <span>￥1800</span>
                         </div>
                     </a>
                 </div>
                 <div>
                     <a href="#">
                         <div>
                             <img src="img/pic.jpg">
                         </div>
                         <h5>图说有道</h5>
                         <p>快速提高儿童认知语言能力快速快速...</p>
                         <div>
                             <span>￥999</span>
                             <span>￥1800</span>
                         </div>
                     </a>
                 </div>
             </div>
             <a onclick="handleAddContent(3)"><h6>查看更多</h6></a>
         </div>
         <!--教具/教材专区-->
         <div class="lineBox">
             <h4>教具/教材专区</h4>
             <div class="line2" id="teach">
                 <!--<div>
                     <div>
                         <img src="img/pic.jpg">
                     </div>
                     <h5>图说有道</h5>
                     <p>快速提高儿童认知语言能力快速快速...</p>
                     <div>
                         <span>￥999</span>
                         <span>￥1800</span>
                     </div>
                 </div>
                 <div>
                     <a href="#">
                         <div>
                             <img src="img/pic.jpg">
                         </div>
                         <h5>图说有道</h5>
                         <p>快速提高儿童认知语言能力快速快速...</p>
                         <div>
                             <span>￥999</span>
                             <span>￥1800</span>
                         </div>
                     </a>
                 </div>
                 <div>
                     <a href="#">
                         <div>
                             <img src="img/pic.jpg">
                         </div>
                         <h5>图说有道</h5>
                         <p>快速提高儿童认知语言能力快速快速...</p>
                         <div>
                             <span>￥999</span>
                             <span>￥1800</span>
                         </div>
                     </a>
                 </div>
                 <div>
                     <a href="#">
                         <div>
                             <img src="img/pic.jpg">
                         </div>
                         <h5>图说有道</h5>
                         <p>快速提高儿童认知语言能力快速快速...</p>
                         <div>
                             <span>￥999</span>
                             <span>￥1800</span>
                         </div>
                     </a>
                 </div>
                 <div>
                     <a href="#">
                         <div>
                             <img src="img/pic.jpg">
                         </div>
                         <h5>图说有道</h5>
                         <p>快速提高儿童认知语言能力快速快速...</p>
                         <div>
                             <span>￥999</span>
                             <span>￥1800</span>
                         </div>
                     </a>
                 </div>
                 <div>
                     <a href="#">
                         <div>
                             <img src="img/pic.jpg">
                         </div>
                         <h5>图说有道</h5>
                         <p>快速提高儿童认知语言能力快速快速...</p>
                         <div>
                             <span>￥999</span>
                             <span>￥1800</span>
                         </div>
                     </a>
                 </div>-->
             </div>
             <a onclick="handleAddContent(2)">
                 <h6>查看更多</h6>
             </a>
         </div>
     </div>
</div>
</body>
</html>
<script>
    function goTopup() {
        window.location='topUp.html'
    }
    $(function(){
        var user1 = sessionStorage.getItem("userId")
        console.log(user1);
        $.ajax({
            url:baseURL + 'system/customer/getById',
            type:'post',
            data:{"id":user1},
            success:function(res){
                console.log(res);
                var changeMoney = `
                    <img src="img/qian.png">
                    <span>堡币剩余:${res.rows.rechargePrice}</span>
                    <p>
                        <span style="margin-left: .7rem">赠送堡币:${res.rows.givePrice}</span>
                    </p>`;
                $('#changeMoney').html(changeMoney)
            },
            error:function(error){
                console.log(error)
            },
        })
        $.ajax({
            url:baseURL + 'mall/goods/goodsGroup',
            type:'post',
            success:function(res){
                console.log(res);
                if(res.status==200){
                    dataTeach=res.teachList.data;
                    var dataSelfRes=res.selfResList.data;
                    var dataService=res.serviceList.data;
                    dataLesson=res.courseList.data;
                    console.log(dataSelfRes);
                    var teachItem = '';//教具教材
                    var lessonItem = ''//课程
                    
                    var serviceItem = ''//行业服务
                    var selfResItem = '';// 自研项目
                    for(i=0;i<dataTeach.length;i++){
                        console.log(dataTeach[i].type);
                        var mark = dataTeach[i].intro
                        if(mark.length>15){
                            mark = mark.substr(0,15)+ "..." ;
                        }else{
                            mark=mark;
                        }
                        console.log();

                        teachItem += `<div  onclick="handleDetails(${dataTeach[i].id})">
                                <div>
                                    <img src="${dataTeach[i].cover}">
                                </div>
                                <h5>${dataTeach[i].name}</h5>
                                <p>${mark}</p>
                                <div>
                                    <span>￥${dataTeach[i].price}</span>
                                    <span>￥${dataTeach[i].originalPrice}</span>
                                </div>
                             </div>`
                    }
                    // 行业服务
                    for(i=0;i<dataService.length;i++){
                        console.log(dataService[i].type);
                        var mark = dataService[i].intro
                        if(mark.length>15){
                            mark = mark.substr(0,15)+ "..." ;
                        }else{
                            mark=mark;
                        }
                        console.log();

                        serviceItem += `<div  onclick="handleDetails(${dataService[i].id})">
                                <div>
                                    <img src="${dataService[i].cover}">
                                </div>
                                <h5>${dataService[i].name}</h5>
                                <p>${mark}</p>
                                <div>
                                    <span>￥${dataService[i].price}</span>
                                    <span>￥${dataService[i].originalPrice}</span>
                                </div>
                             </div>`
                    }
                    //课程
                    for(i=0;i<dataLesson.length;i++){
                        console.log(dataLesson[i].type);
                        var mark = dataLesson[i].intro
                        if(mark.length>20){
                            mark = mark.substr(0,20)+ "..." ;
                        }else{
                            mark=mark;
                        }
                        console.log();

                        lessonItem += `
                            <div onclick="handleDetails(${dataLesson[i].id})">
                                <div>
                                    <img src="${dataLesson[i].cover}">
                                </div>
                                <h5>${dataLesson[i].name}</h5>
                                <p>${mark}</p>
                                <div>
                                    <span>￥${dataLesson[i].price}</span>
                                    <span>￥${dataLesson[i].originalPrice}</span>
                                </div>
                            </div>`
                    }
                    // 教具教材
                    for(i=0;i<dataSelfRes.length;i++){
                        // console.log(dataSelfRes[i].type);
                        var mark = dataSelfRes[i].intro
                        if(mark.length>20){
                            mark = mark.substr(0,20)+ "..." ;
                        }else{
                            mark=mark;
                        }
                        // console.log();

                        selfResItem += `
                            <div onclick="handleDetails(${dataSelfRes[i].id})">
                                <div>
                                    <img src="${dataSelfRes[i].cover}">
                                </div>
                                <h5>${dataSelfRes[i].name}</h5>
                                <p>${mark}</p>
                                <div>
                                    <span>￥${dataSelfRes[i].price}</span>
                                    <span>￥${dataSelfRes[i].originalPrice}</span>
                                </div>
                            </div>`
                    }
                    $("#teach").html(teachItem);
                    $("#lesson").html(lessonItem);
                    $("#selfRes").html(selfResItem);
                    $("#service").html(serviceItem);
                }else{
                    layer.msg("出故障了")
                }
            },
            error:function(error){
                console.log(error)
            }
        })
    })
    var teachListNumber = 2;
    var courseListNumber = 2;
    function handleAddContent(type){//1-教育教材，2-自研，3-课程  4-行业服务， 5-自营， 加载更多
        console.log(dataLesson)
        var page;
        console.log(page)
        if (type==2){
            page = teachListNumber++;
        }
        else if (type==3){
            page = courseListNumber++;
        }

        console.log(page)
        $.ajax({
            url:baseURL + 'mall/goods/goodsList?rows=2&page='+page+'&type='+type,
            type:'post',
            success:function(res){
                console.log(page)
                // console.log(res);
                var moreLoad = res.rows;
                var teachItem = '';//教具教材
                var lessonItem = '';//课程
                console.log(moreLoad);
                for(i=0;i<moreLoad.length;i++){
                    type1=moreLoad[0].type;
                    console.log(type1)
                    var mark = moreLoad[i].intro
                    if(mark.length>20){
                        mark = mark.substr(0,20)+ "..." ;
                    }else{
                        mark=mark;
                    }
                    if(moreLoad[i].type==3){
                        lessonItem += `
                            <div onclick="handleDetails(${moreLoad[i].id})">
                                <div>
                                    <img src="${moreLoad[i].cover}">
                                </div>
                                <h5>${moreLoad[i].name}</h5>
                                <p>${mark}</p>
                                <div>
                                    <span>￥${moreLoad[i].price}</span>
                                    <span>￥${moreLoad[i].originalPrice}</span>
                                </div>
                            </div>`;
                    }
                    if(moreLoad[i].type==2){
                        teachItem  += `
                            <div onclick="handleDetails(${moreLoad[i].id})">
                                <div>
                                    <img src="${moreLoad[i].cover}">
                                </div>
                                <h5>${moreLoad[i].name}</h5>
                                <p>${mark}</p>
                                <div>
                                    <span>￥${moreLoad[i].price}</span>
                                    <span>￥${moreLoad[i].originalPrice}</span>
                                </div>
                            </div>`;
                    }
                }
                $("#teach").append(teachItem);
                $("#lesson").append(lessonItem);
                if(res.rows.length!==0 && res.rows[0].type==3){
                    dataLesson = dataLesson.concat(res.rows);
                    page = courseListNumber++;
                    console.log(dataLesson);
                }else if(res.rows.length!==0 && res.rows[0].type==2){
                    dataTeach  = dataTeach.concat(res.rows);
                    page = teachListNumber++;
                    console.log(dataTeach);
                }else{
                    layer.msg("没有更多了！")
                }
            },
            error:function(error){
                console.log(error)
            }
        })
    }
    function handleDetails(productId){
        window.location='afterProductDrtails.html?id='+productId
    }
</script>